### 结构型模式 6 ： 享元模式（Flyweight）
定义：运用共享技术来有效地支持大量细粒度对象的复用。它通过共享已经存在的对象来大幅度减少需要创建的对象数量、避免大量相似类的开销，从而提高系统资源的利用率。

享元模式的主要优点是：相同对象只要保存一份，这降低了系统中对象的数量，从而降低了系统中细粒度对象给内存带来的压力。

其主要缺点是：
* 为了使对象可以共享，需要将一些不能共享的状态外部化，这将增加程序的复杂性。
* 读取享元模式的外部状态会使得运行时间稍微变长。


享元模式的主要角色有如下。
* 抽象享元角色（Flyweight）：是所有的具体享元类的基类，为具体享元规范需要实现的公共接口，非享元的外部状态以参数的形式通过方法传入。
* 具体享元（Concrete Flyweight）角色：实现抽象享元角色中所规定的接口。
* 非享元（Unsharable Flyweight)角色：是不可以共享的外部状态，它以参数的形式注入具体享元的相关方法中。
* 享元工厂（Flyweight Factory）角色：负责创建和管理享元角色。当客户对象请求一个享元对象时，享元工厂检査系统中是否存在符合要求的享元对象，如果存在则提供给客户；如果不存在的话，则创建一个新的享元对象。



![](https://yinyang.space/img/gof_flyweight.png)

* UnsharedConcreteFlyweight 是非享元角色，里面包含了非共享的外部状态信息 info；
* Flyweight 是抽象享元角色，里面包含了享元方法 operation(UnsharedConcreteFlyweight state)，非享元的外部状态以参数的形式通过该方法传入；
* ConcreteFlyweight 是具体享元角色，包含了关键字 key，它实现了抽象享元接口；
* FlyweightFactory 是享元工厂角色，它是关键字 key 来管理具体享元；
* 客户角色通过享元工厂获取具体享元，并访问具体享元的相关方法。


